<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hyacinth - Employee</title>

    <!-- Styles -->
    <link rel="stylesheet" href="../../style/employee.css" />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Lexend&display=swap"
      rel="stylesheet"
    />

    <!-- Scripts -->
    <script type="module" src="../sidebar/sidebar.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.3.2/js/dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
      /* Basic modal styling */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        width: 400px;
        position: relative;
      }

      .close-modal {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 18px;
        cursor: pointer;
        background: none;
        border: none;
      }
    </style>
  </head>

  <body>
    <main-sidebar></main-sidebar>

    <div class="wrap-container">
      <div class="employee-header">
        <div class="header-title">
          <h1>Employee Details</h1>
        </div>

        <div class="header-actions">
          <button class="top-btn">
            <i class="fa-solid fa-user-plus"></i> Add Employee
          </button>
        </div>
      </div>


      <div class="filter-buttons">
        <select id="filterDepartment">
          <option value="">All Departments</option>
          <option value="ADMIN">ADMIN</option>
          <option value="IT">IT</option>
          <option value="HR">HR</option>
        </select>

        <select id="filterJob">
          <option value="">All Job Titles</option>
          <option value="HR Officer">HR Officer</option>
          <option value="Software Developer">Software Developer</option>
        </select>

        <select id="filterStatus">
          <option value="">All Status</option>
          <option value="Active">Active</option>
          <option value="Inactive">Inactive</option>
        </select>

        <input
          type="date"
          id="filterHireDate"
          name="filterHireDate"
          placeholder="Hire Date"
        />
      </div>

      <div class="data-table-container">
        <table id="employeeTable" class="dataTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Hire Date</th>
              <th>Status Type</th>
              <th>Email</th>
              <th>Referred By</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Jane Doe</td>
              <td>06/12/2025</td>
              <td>REGULAR</td>
              <td>janedoe@gmail.com</td>
              <td>John Doe</td>
              <td class="action-btns">
                <button
                  class="view-btn icon-btn view"
                  title="View"
                  onclick='showEmployeeDetails({
                    name: "Jane Doe",
                    dob: "1990-05-15",
                    address: "123 Main St",
                    phone: "09171234567",
                    email: "jane@example.com",
                    job: "HR Officer",
                    department: "ADMIN",
                    organization: "HHI",
                    statusType: "REGULAR",
                    hireDate: "2021-06-01",
                    referredBy: "John Doe",
                    status: "Active"
                  })'
                >
                  <i class="fas fa-eye"></i>
                </button>
                <button class="edit-btn icon-btn edit" title="Edit">
                  <i class="fas fa-pen"></i>
                </button>
                <button class="delete-btn icon-btn delete" title="Delete">
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Modal Structure -->
    <div id="employeeModal" class="modal">
      <div class="modal-content">
        <button class="close-modal">&times;</button>
        <h3>Employee Details</h3>
        <p><strong>Name:</strong> <span id="empName"></span></p>
        <p><strong>DOB:</strong> <span id="empDob"></span></p>
        <p><strong>Address:</strong> <span id="empAddress"></span></p>
        <p><strong>Phone:</strong> <span id="empPhone"></span></p>
        <p><strong>Email:</strong> <span id="empEmail"></span></p>
        <p><strong>Job Title:</strong> <span id="empJob"></span></p>
        <p><strong>Department:</strong> <span id="empDept"></span></p>
        <p><strong>Hire Date:</strong> <span id="empHire"></span></p>
        <p><strong>Status:</strong> <span id="empStatus"></span></p>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const table = $("#employeeTable").DataTable();

        // Filters
        $("#filterDepartment").on("change", function () {
          table.column(3).search(this.value).draw();
        });

        $("#filterJob").on("change", function () {
          table.column(2).search(this.value).draw();
        });

        $("#filterStatus").on("change", function () {
          table.column(6).search(this.value).draw();
        });

        $("#filterHireDate").on("change", function () {
          table.column(5).search(this.value).draw();
        });

        // Delete button confirmation
        document.querySelectorAll(".delete-btn").forEach((button) => {
          button.addEventListener("click", function () {
            const ItemId = this.getAttribute("data-id");

            Swal.fire({
              title: "Are you Sure?",
              text: "This can't be undone!",
              icon: "warning",
              showCancelButton: true,
              confirmButtonColor: "#e3342f",
              cancelButtonColor: "#6c757d",
              confirmButtonText: "Yes, please delete it!",
            }).then((result) => {
              if (result.isConfirmed) {
                window.location.href = `delete.php?id=${ItemId}`;
              }
            });
          });
        });

        // Modal
        const modal = document.getElementById("employeeModal");
        const closeModalBtn = document.querySelector(".close-modal");

        window.showEmployeeDetails = function (employee) {
          document.getElementById("empName").textContent = employee.name;
          document.getElementById("empDob").textContent = employee.dob;
          document.getElementById("empAddress").textContent = employee.address;
          document.getElementById("empPhone").textContent = employee.phone;
          document.getElementById("empEmail").textContent = employee.email;
          document.getElementById("empJob").textContent = employee.job;
          document.getElementById("empDept").textContent = employee.department;
          document.getElementById("empHire").textContent = employee.hireDate;
          document.getElementById("empStatus").textContent = employee.status;

          modal.style.display = "flex";
        };

        closeModalBtn.onclick = function () {
          modal.style.display = "none";
        };

        window.onclick = function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        };
      });
    </script>
  </body>
</html>
